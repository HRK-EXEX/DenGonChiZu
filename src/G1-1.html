<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G1-1</title>
<link rel="stylesheet" href="css/G1-1.css">
<link rel="stylesheet" href="css/side.css">
</head>
<body>
    <div id="sidebar-container"></div>


    <div id="content">
        <!-- 投稿座標部分 -->
        <div class="post-container" style="top: 200px; left: 300px;">
            <div class="user-info">
                <img src="../img/user_icon.jpg" alt="ユーザのアイコン">
                <span class="username">ユーザ名</span>
            </div>
            <div class="post-content">
                <p>投稿内容がここに表示されます。投稿内容がここに表示されます。投稿内容がここに表示されます。</p>
            </div>
            <div class="interaction">
                <span class="comment-icon">💬</span>
                <span class="comment-count">5</span>
                <span class="like-icon">❤️</span>
                <span class="like-count">10</span>
            </div>
        </div>

        <!-- サンプル部分。後でバッグエンドで関数化して追加方式に変更する -->
        <div class="post-container" style="top: 400px; left: 700px;">
            <div class="user-info">
                <img src="../img/user_icon.jpg" alt="ユーザのアイコン">
                <span class="username">ユーザ名</span>
            </div>
            <div class="post-content">
                <p>投稿内容がここに表示されます。投稿内容がここに表示されます。投稿内容がここに表示されます。
                    投稿内容がここに表示されます。投稿内容がここに表示されます。投稿内容がここに表示されます。
                </p>
            </div>
            <div class="interaction">
                <span class="comment-icon">💬</span>
                <span class="comment-count">25</span>
                <span class="like-icon">❤️</span>
                <span class="like-count">190</span>
            </div>
        </div>
    </div>

    <!-- ボタンは #content の外に配置 -->
    <button id="addCommentButton"></button>

    <script>
                // サイドバーを読み込むスクリプト
                fetch('side.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('sidebar-container').innerHTML = data;
            });


        var content = document.getElementById("content");
        var isDragging = false;
        var initialX, initialY;

        // マウスが押された時のイベントリスナーの設定
        content.addEventListener("mousedown", function(event) {
            if (event.target.id !== "addCommentButton") {
                isDragging = true;
                initialX = event.clientX - content.offsetLeft;
                initialY = event.clientY - content.offsetTop;
                content.style.cursor = "grabbing";
                content.addEventListener("mousemove", mousemoveHandler);
            }
        });

        // マウスが離された時のイベントリスナーの設定
        document.addEventListener("mouseup", function() {
            if (isDragging) {
                isDragging = false;
                content.style.cursor = "grab";
                content.removeEventListener("mousemove", mousemoveHandler);
            }
        });

        // マウスが動いた時のイベントリスナーの設定
        function mousemoveHandler(event) {
            if (isDragging) {
                var newX = event.clientX - initialX;
                var newY = event.clientY - initialY;
                content.style.left = newX + "px";
                content.style.top = newY + "px";
            }
        }

        var addCommentButton = document.getElementById("addCommentButton");

        // ボタンがクリックされた時のイベントリスナーの設定
        addCommentButton.addEventListener("click", function(event) {
            // クリックしたときのマウス座標を取得
            var mouseX = event.clientX;
            var mouseY = event.clientY;

            // #content の位置を取得
            var contentRect = content.getBoundingClientRect();
            var contentLeft = contentRect.left;
            var contentTop = contentRect.top;

            // マウス座標を #content からの相対座標に変換
            var relativeX = mouseX - contentLeft;
            var relativeY = mouseY - contentTop;

            // 座標情報をURLのクエリパラメータに追加して画面遷移
            // var url = `newPage.html?x=${relativeX}&y=${relativeY}`;
            // window.location.href = url;

            alert(`Relative X: ${relativeX}px`);
            alert(`Relative Y: ${relativeY}px`);
        });

    </script>
</body>
</html>
